# 安全相关的问题
### 目录

---
<a href="#1">1. 攻击网站的方法和原理。</a> <br>
<a href="#2">2. 怎么确保数据传输过程中的安全性?</a> <br>


### <a name="1">1. 攻击网站的方法和原理。</a>

#### 1..DDos 攻击(见上面的)
#### 2.XSS 攻击
&ensp;&ensp;&ensp;&ensp;
    又叫“跨站脚本攻击”。它指的是恶意攻击者往 Web 页面里插入恶意 html 代码,当
用户浏览该页之时,嵌入其中 Web 里面的 html 代码会被执行,从而达到恶意的特殊目的。
XSS 是实现 CSRF 的诸多途径中的一条,但绝对不是唯一的一条。比如:有些人在留言
板中输入恶意脚本来获取用户的帐号和密码。 <br>
&ensp;&ensp;&ensp;&ensp;
    XSS 全称“跨站脚本”,是注入攻击的一种。其特点是不对服务器端造成任何伤害,
而是通过一些正常的站内交互途径,例如发布评论,提交含有 JavaScript 的内容文本。这
时服务器端如果没有过滤或转义掉这些脚本,作为内容发布到了页面上,其他用户访问这
个页面的时候就会运行这些脚本。 <br>
恶意用户会这么输入:
![03_1_1](/data/images/Java应届生面试突击/计算机网络/03_1_1.png)

上面演示的是一个非常简单的 XSS 攻击,还有很多隐蔽的方式,但是其核心都是利用
了脚本注入。 <br>

*输入检查* <br>
&ensp;&ensp;&ensp;&ensp;
    输入检查一般是检查用户输入的数据中是否包含一些特殊字符,如<、>、'、"等,如果
发现存在特殊字符,则将这些字符转义。

#### 3.CSRF 攻击
又叫“跨站请求伪造”。可以这么理解 CSRF 攻击:攻击者盗用了你的身份,以你的
名义发送恶意请求。CSRF 能够做的事情包括:以你名义发送邮件,发消息,盗取你的账
号,甚至于购买商品,虚拟货币转账......造成的问题包括:个人隐私泄露以及财产安全。
下图简单阐述了 CSRF 攻击的思想: <br>
![03_1_2](/data/images/Java应届生面试突击/计算机网络/03_1_2.png)

1. 用户 C 打开浏览器,访问受信任网站 A,输入用户名和密码请求登录网站 A; <br>
2.在用户信息通过验证后,网站 A 产生 Cookie 信息并返回给浏览器,此时用户登录网
站 A 成功,可以正常发送请求到网站 A; <br>
3. 用户未退出网站 A 之前,在同一浏览器中,打开一个 TAB 页访问网站 B; <br>
4. 网站 B 接收到用户请求后,返回一些攻击性代码,并发出一个请求要求访问第三方
站点 A; <br>
5. 浏览器在接收到这些攻击性代码后,根据网站 B 的请求,在用户不知情的情况下携
带 Cookie 信息,向网站 A 发出请求。网站 A 并不知道该请求其实是由 B 发起的,所以会根
据用户 C 的 Cookie 信息以 C 的权限处理该请求,导致来自网站 B 的恶意代码被执行。 <br>

从上图可以看出,要完成一次 CSRF 攻击,受害者必须依次完成两个步骤: <br>
1. 登录受信任网站 A,并在本地生成 Cookie。 <br>
2. 在不退出 A 的情况下,访问危险网站 B。 <br>

##### 示例:
银行网站 A,它以 GET 请求来完成银行转账的操作,如: <br>
http://www.mybank.com/Transfer.php?toBankId=11&money=1000 <br>
危险网站 B,它里面有一段 HTML 的代码如下:
```html
<img src=http://www.mybank.com/Transfer.php?toBankId=11&money=1000>
```
&ensp;&ensp;&ensp;&ensp;
    首先,你登录了银行网站 A,然后访问危险网站 B,噢,这时你会发现你的银行账户
少了 1000 块。 <br>
&ensp;&ensp;&ensp;&ensp;
    为什么会这样呢?原因是银行网站 A 违反了 HTTP 规范,使用 GET 请求更新资源。
在访问危险网站 B 的之前,你已经登录了银行网站 A,而 B 中的<img>以 GET 的方式请求
第三方资源(这里的第三方就是指银行网站了,原本这是一个合法的请求,但这里被不法
分子利用了),所以你的浏览器会带上你的银行网站 A 的 Cookie 发出 Get 请求,去获取资
源“http://www.mybank.com/Transfer.php?toBankId=11&money=1000”,结果银行网站
服务器收到请求后,认为这是一个更新资源操作(转账操作),所以就立刻进行转账操作。

##### 防御方法:
    3.1. CSRF 攻击是有条件的,当用户访问恶意链接时,认证的 cookie 仍然有效,所以
当用户关闭页面时要及时清除认证 cookie。 <br>
    3.2. 在客户端页面增加伪随机数。在所有 POST 方法提交的数据中提供一个不可预测
的参数,比如一个随机数或者一个根据时间计算的 HASH 值,并且在 Cookie 中也同样保
存这个参数值(保证 2 者数值的一致)。把这个参数嵌入标签保存在 FORM 表单中,当浏
览器提交 POST 请求到服务器端时,从 POST 数据中取出这个参数并且和 Cook.ie 中的
值做比较,如果两个值相等则认为请求有效,不相等则拒绝。根据同源策略和 Cookie 的安
全策略,第三方网页是无法取得 Cookie 中的参数值的.所以它不能构造出相同随机参数
的 POST 请求。
```php
<?php
    //构造加密的 Cookie 信息
    $value = “DefenseSCRF”;
    setcookie(”cookie”, $value, time()+3600);
?>

在表单里增加 Hash 值,以认证这确实是用户发送的请求。

<?php
    $hash = md5($_COOKIE['cookie']);
?>

<form method=”POST” action=”transfer.php”>
    <input type=”text” name=”toBankId”>
    <input type=”text” name=”money”>
    <input type=”hidden” name=”hash” value=”<?=$hash;?>”>
    <input type=”submit” name=”submit” value=”Submit”>
</form>

然后在服务器端进行 Hash 值验证

<?php
    if(isset($_POST['check'])) {
        $hash = md5($_COOKIE['cookie']);
        if($_POST['check'] == $hash) {
            doJob();
        } else {
            //...
        }
    } else {
        //...
    }
?>

```
3.3.图片验证码

##### 4.SQL 注入攻击
见《数据库部分》。 <br>
&ensp;&ensp;&ensp;&ensp;
    https 怎么做到安全的。https 的实现过程(工作原理)。HTTPS 如何加密, HTTPS 加
密算法 SSL。 网络安全协议 SSL 协议及完整交互过程。解释 https (先公私钥加密,再
对称加密) 为什么不直接公私钥。MD5 加盐。怎么对传输的数据加密。对称加密和非对称
加密( 公钥加密 )。RSA 算法的机制(-> 加密通信连接建立的过程) 。

### <a name="2">2. 怎么确保数据传输过程中的安全性?</a>

#### 1.数据加密:
1.1 单向散列算法:MD5,SHA1。 <br>
MD5 是单向散列算法,可用来校验数据的完整性。 <br>
功能: <br>
输入任意长度的信息,经过处理,输出为 128 位的信息(数字指纹); <br>
不同的输入得到的不同的结果(唯一性); <br>
根据 128 位的输出结果不可能反推出输入的信息(不可逆); <br>
用途: <br>
- 1)防止被篡改,比如我提供文件下载,为了防止不法分子在安装程序中添加木马,我
可以在网站上公布由安装文件得到的 MD5 输出结果。
- 2)防止直接看到明文,现在很多网站在数据库存储用户的密码的时候都是存储用户密
码的 MD5 值。这样就算不法分子得到数据库的用户密码的 MD5 值,也无法知道用户的密
码。
- 3)防止抵赖(数字签名),例如 A 写了一个文件,认证机构对此文件用 MD5 算法产生
摘要信息并做好记录。这样可以防止出现以后 A 不承认此事而带来的麻烦。 <br>
1.2 对称加密算法:DES, AES, RC4。 <br>
    AES:高级加密标准,是下一代的加密算法标准,速度快,安全级别高。
1.3 非对称加密算法:RSA,DSA。 <br>

#### 2.权限控制

---
### 搬运工信息
Author:Jason Lou <br>
Email:vip.iotworld@gmail.com <br>
Blog:https://blog.csdn.net/qq_21508727 <br>
Github:https://github.com/JGPY/JavaGuideBooster <br>
---
