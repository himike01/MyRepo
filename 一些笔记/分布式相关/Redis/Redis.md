- Redis基础结构？在什么情 况下合适
字符串String、列表List、集合Set、散列表、有序集合SortedSet
Redis的这些结构都是对象系统实现的。
1. 对于字符串来说，是字符串类型的键和值
使用了SDS 动态字符串结构
对于不同大小的对象，采用不同的编码方式，也就决定了不同的内存分配方式和不同命令的实现方式
2. 对于列表对象来说
有ziplist压缩列表和linkedlist链表两种编码
3. 对于哈希对象来说，
有ziplist和hashtable两种编码
4. 对于集合来说
有intset和hashtable两种编码
5. 对于有序集合对象来说 zset
有ziplist和跳表两种实现

- 说一下跳表
为链表增加索引的方式，插入查找都为logn


缓存雪崩：大量缓存数据同时间失效，导致用户直接发起大量请求到数据库，产生瓶颈。
1、生成随机失效的缓存时间数据；
2、让缓存节点分布在不同的物理节点上； 
3、生成不失效的缓存数据；
4、定时任务更新缓存数据；

缓存穿透：用户请求数据，例如ID为负数，不存在缓存里，也不存在数据库里，会造成缓存穿透。
1、无意义数据放入缓存，下一次相同请求就会命中缓存；
2、IP过滤；
3、参数校验；
4、布隆过滤器；

缓存失效：由于缓存热点键到时失效导致用户请求直接访问数据库
1、用久缓存；
2、分布式锁
 a.单体应用—>互斥锁—>zookeeper ,redis实现。

- Redis的删除策略有哪些？
定时删除，定期删除，惰性删除

 
- Redis的持久化方法？
AOF持久化和RDB持久化
RDB是写到磁盘上
RDB有两种方式，一种是阻塞主进程，一种是创建新进程
AOF是追加到日志文件中
AOF重写有两种方式

- Redis为什么这么快？
多进程

- 说一下redis的一致性哈希策略
redis维护一个哈希槽，所有的master分配这个哈希槽

- redis集群模式
主从复制
哨兵模式
cluster模式

- 主从复制原理？优缺点？
从服务器sync主服务器，主服务器创建快照（缓冲写命令），同步快照（缓冲写命令），同步写缓存，之后同步增量。
优点：
读写分离
有效分载master同步压力
非阻塞服务
保证最终一致性
缺点：
无法保证强一致性
不具备自动容错和恢复功能
切换ip会引发数据不一致的问题
难以在线扩容


- 哨兵模式是什么？工作方式是什么？
哨兵用于监控运行的多个redis实例，
通过发送命令，让 Redis 服务器返回监控其运行状态，包括主服务器和从服务器；
当哨兵监测到 master 宕机，会自动将 slave 切换成 master ，然后通过发布订阅模式通知其他的从服务器，修改配置文件，让它们切换主机

工作方式：
哨兵标记主观下线和客观下线，然后发送INFO命令

- 哨兵模式的优缺点？
优点：可以

- cluster模式？
cluster模式实际就是多主模式
一般需要6个以上的节点保证可用性


- 说一下redis分布式锁，有什么问题？如何解决？
基本思路：
使用set/setnx加锁，成功执行expire添加过期时间
解锁执行delete命令
更好的实现：
使用lua redis脚本，设置看门狗延长时间

- 分布式锁并发遇到的锁不是自己的问题如何解决？
使用lua脚本变成原子的，先判断是否是自己的锁，如果是自己的锁，然后再去释放

- 锁的过期时间不好评估怎么办？
开启一个守护线程，定时检测锁的过期时间

- ziplist结构是什么样的？
ziplist由内存字节数，头尾间距，节点数，节点，尾节点构成

- 多节点时如何实现分布式锁？
Redlock算法
